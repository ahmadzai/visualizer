{% extends 'template.html.twig' %}

{% block content %}

    <script src="{{ asset('charts/highcharts.js') }}"></script>
    <script src="{{ asset('charts/modules/heatmap.js') }}"></script>
    <script src="{{ asset('charts/modules/exporting.js') }}"></script>
    <script src="{{ asset('charts/modules/grouped-categories.js') }}"></script>
    <!-- Current Row -->
    <div class="row">
        <div class="col-md-12">
            <div class="box box-default bg-gray">
                <div class="box-header with-border">
                    <h3 class="box-title campaign-title">{{ campaign }} Campaign Data </h3>
                    <span class="badge bg-gray-light" style="font-weight: normal; color:black">Source: Catchup Data</span>
                    <span class="loading" title="Applying filter" style="margin-left: 12%; display: inline-block;">
                        <img src='{{ asset('filtering.gif')}}' />
                    </span>
                    <a class="pull-right btn-sm btn-primary btn-cluster"
                       style="cursor:pointer" target="_blank" href="{{ path("cluster_catchup_data") }}">
                        <i class="fa fa-mail-forward"></i> For clusters' data click here!
                    </a>
                </div>
                <div class="box-body">

                    <!-- Start of First Row --->
                    <div class="row">
                    <div class="col-md-9">
                        <div class="row info-row">
                           {{ info|raw }}
                        </div>
                        <div class="row">
                            <div class="col-md-12">
                                <div class="box box-primary">
                                     <div class="box-body table-campaign-info">
                                        {{ table|raw }}
                                     </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="box box-primary">
                                     <div class="box-body" style="padding: 1px;">
                                        <div id="chart-pie_chart_1camp" style="height: 200px; max-height: 250px;" >
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-12">

                                <div class="box box-primary">
                                    <div class="box-body" style="padding: 1px;">
                                        <div id="chart-column_chart_1camp" style="height: 200px; max-height: 250px;"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                    <!-- End of First Row --->
                    <!-- Second Row --->
                    <div class="row">
                        <div class="col-md-3">
                            <div class="box box-warning">
                                <div class="box-body" style="padding: 1px">
                                    <div id="chart-recovered_all" style="height: 200px; max-height: 250px;"></div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="box box-warning">
                                <div class="box-body" style="padding: 1px">
                                    <div id="chart-recovered_absent" style="height: 200px; max-height: 250px;"></div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="box box-warning">
                                <div class="box-body" style="padding: 1px">
                                    <div id="chart-recovered_nss" style="height: 200px; max-height: 250px;"></div>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-3">
                            <div class="box box-warning">
                                <div class="box-body" style="padding: 1px">
                                    <div id="chart-recovered_refusal" style="height: 200px; max-height: 250px;"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End of second row -->
                </div>
            </div>
        </div>
    </div>
    <!-- End of Current Campaign Row-->
    <!-- Start of the 10 Campaign Trends --->
    <div class="row">
        <div class="col-md-12">
            <div class="box box-default bg-gray-light">
                <div class="box-header with-border">
                    <h3 class="box-title last10-campaign-title">Last 10 Campaigns' Trend </h3>
                    <span class="badge bg-gray" style="font-weight: normal">Source: Catchup Data</span>
                </div>
                <div class="box-body">
                    <div class="row">
                        <div class="col-md-4">
                            <div class="box box-primary">
                                <div class="chart-filter">
                                    <span><a href="#"><i class="fa fa-filter"></i></a></span>
                                    <div class="filter-content">
                                        <a class="campaign-type" href="#" title="NID" data-url="vac_child_10camp">NID</a>
                                        <a class="campaign-type" href="#" title="SNID" data-url="vac_child_10camp">SNID</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="vac_child_10camp">LPD</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="vac_child_10camp">Reset</a>
                                    </div>
                                </div>
                                <span class="filter-loading loading vac_child_10camp" title="Applying filter">
                                    <img src='{{ asset('ajax-loader-arrow.gif')}}' />
                                </span>
                                <div class="box-body">
                                    <div id="chart-vac_child_10camp" style="min-width: 300px; height: 350px; max-width:inherit"></div>
                                </div>
                                <!-- /.box-body -->
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="box box-primary">
                                <div class="chart-filter">
                                    <span><a href="#"><i class="fa fa-filter"></i></a></span>
                                    <div class="filter-content">
                                        <a class="campaign-type" href="#" title="NID" data-url="missed_10camp">NID</a>
                                        <a class="campaign-type" href="#" title="SNID" data-url="missed_10camp">SNID</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="missed_10camp">LPD</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="missed_10camp">Reset</a>
                                    </div>
                                </div>
                                <span class="filter-loading loading missed_10camp" title="Applying filter"><img src='{{ asset('ajax-loader-arrow.gif')}}' /></span>
                                <div class="box-body">
                                    <div id="chart-missed_10camp" style="min-width: 300px; height: 350px; max-width:inherit"></div>
                                </div>
                                <!-- /.box-body -->
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="box box-primary">
                                <div class="chart-filter">
                                    <span><a href="#"><i class="fa fa-filter"></i></a></span>
                                    <div class="filter-content">
                                        <a class="campaign-type" href="#" title="NID" data-url="missed_type_10camp">NID</a>
                                        <a class="campaign-type" href="#" title="SNID" data-url="missed_type_10camp">SNID</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="missed_type_10camp">LPD</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="missed_type_10camp">Reset</a>
                                    </div>
                                </div>
                                <span class="filter-loading loading missed_type_10camp" title="Applying filter"><img src='{{ asset('ajax-loader-arrow.gif')}}' /></span>
                                <div class="box-body">
                                    <div id="chart-missed_type_10camp" style="min-width: 300px; height: 350px; max-width:inherit"></div>
                                </div>
                                <!-- /.box-body -->
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="box box-primary">
                                <div class="chart-filter">
                                    <span><a href="#"><i class="fa fa-filter"></i></a></span>
                                    <div class="filter-content">
                                        <a class="campaign-type" href="#" title="NID" data-url="ten_camp_absent">NID</a>
                                        <a class="campaign-type" href="#" title="SNID" data-url="ten_camp_absent">SNID</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="ten_camp_absent">LPD</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="ten_camp_absent">Reset</a>
                                    </div>
                                </div>
                                <span class="filter-loading loading ten_camp_absent" title="Applying filter" data-chart_type="absent">
                                    <img src='{{ asset('ajax-loader-arrow.gif')}}' />
                                </span>
                                <div class="box-body">
                                    <div id="chart-ten_camp_absent" style="min-width: 300px; height: 350px; max-width:inherit"></div>
                                </div>
                                <!-- /.box-body -->
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="box box-primary">
                                <div class="chart-filter">
                                    <span><a href="#"><i class="fa fa-filter"></i></a></span>
                                    <div class="filter-content">
                                        <a class="campaign-type" href="#" title="NID" data-url="ten_camp_nss">NID</a>
                                        <a class="campaign-type" href="#" title="SNID" data-url="ten_camp_nss">SNID</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="ten_camp_nss">LPD</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="ten_camp_nss">Reset</a>
                                    </div>
                                </div>
                                <span class="filter-loading loading ten_camp_nss" title="Applying filter" data-chart_type="nss">
                                    <img src='{{ asset('ajax-loader-arrow.gif')}}' />
                                </span>
                                <div class="box-body">
                                    <div id="chart-ten_camp_nss" style="min-width: 300px; height: 350px; max-width:inherit"></div>
                                </div>
                                <!-- /.box-body -->
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="box box-primary">
                                <div class="chart-filter">
                                    <span><a href="#"><i class="fa fa-filter"></i></a></span>
                                    <div class="filter-content">
                                        <a class="campaign-type" href="#" title="NID" data-url="ten_camp_refusal">NID</a>
                                        <a class="campaign-type" href="#" title="SNID" data-url="ten_camp_refusal">SNID</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="ten_camp_refusal">LPD</a>
                                        <a class="campaign-type" href="#" title="LPD" data-url="ten_camp_refusal">Reset</a>
                                    </div>
                                </div>
                                <span class="filter-loading loading ten_camp_refusal" title="Applying filter" data-chart_type="refusal">
                                    <img src='{{ asset('ajax-loader-arrow.gif')}}' />
                                </span>
                                <div class="box-body">
                                    <div id="chart-ten_camp_refusal" style="min-width: 300px; height: 350px; max-width:inherit"></div>
                                </div>
                                <!-- /.box-body -->
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="box box-primary">
                                {#<div class="chart-filter">#}
                                    {#<span><a href="#"><i class="fa fa-filter"></i></a></span>#}
                                    {#<div class="filter-content">#}
                                        {#<a class="campaign-type" href="#" title="NID" data-url="ten_camp_absent">NID</a>#}
                                        {#<a class="campaign-type" href="#" title="SNID" data-url="ten_camp_absent">SNID</a>#}
                                        {#<a class="campaign-type" href="#" title="LPD" data-url="ten_camp_absent">LPD</a>#}
                                        {#<a class="campaign-type" href="#" title="LPD" data-url="ten_camp_absent">Reset</a>#}
                                    {#</div>#}
                                {#</div>#}
                                <span class="filter-loading loading ten_camp_absent" title="Applying filter" data-chart_type="absent">
                                    <img src='{{ asset('ajax-loader-arrow.gif')}}' />
                                </span>
                                <div class="box-body">
                                    <div id="chart-ten_camp_absent_normal" style="min-width: 300px; height: 350px; max-width:inherit"></div>
                                </div>
                                <!-- /.box-body -->
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="box box-primary">
                                {#<div class="chart-filter">#}
                                    {#<span><a href="#"><i class="fa fa-filter"></i></a></span>#}
                                    {#<div class="filter-content">#}
                                        {#<a class="campaign-type" href="#" title="NID" data-url="ten_camp_nss">NID</a>#}
                                        {#<a class="campaign-type" href="#" title="SNID" data-url="ten_camp_nss">SNID</a>#}
                                        {#<a class="campaign-type" href="#" title="LPD" data-url="ten_camp_nss">LPD</a>#}
                                        {#<a class="campaign-type" href="#" title="LPD" data-url="ten_camp_nss">Reset</a>#}
                                    {#</div>#}
                                {#</div>#}
                                <span class="filter-loading loading ten_camp_nss" title="Applying filter" data-chart_type="nss">
                                    <img src='{{ asset('ajax-loader-arrow.gif')}}' />
                                </span>
                                <div class="box-body">
                                    <div id="chart-ten_camp_nss_normal" style="min-width: 300px; height: 350px; max-width:inherit"></div>
                                </div>
                                <!-- /.box-body -->
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="box box-primary">
                                {#<div class="chart-filter">#}
                                    {#<span><a href="#"><i class="fa fa-filter"></i></a></span>#}
                                    {#<div class="filter-content">#}
                                        {#<a class="campaign-type" href="#" title="NID" data-url="ten_camp_refusal">NID</a>#}
                                        {#<a class="campaign-type" href="#" title="SNID" data-url="ten_camp_refusal">SNID</a>#}
                                        {#<a class="campaign-type" href="#" title="LPD" data-url="ten_camp_refusal">LPD</a>#}
                                        {#<a class="campaign-type" href="#" title="LPD" data-url="ten_camp_refusal">Reset</a>#}
                                    {#</div>#}
                                {#</div>#}
                                <span class="filter-loading loading ten_camp_refusal" title="Applying filter" data-chart_type="refusal">
                                    <img src='{{ asset('ajax-loader-arrow.gif')}}' />
                                </span>
                                <div class="box-body">
                                    <div id="chart-ten_camp_refusal_normal" style="min-width: 300px; height: 350px; max-width:inherit"></div>
                                </div>
                                <!-- /.box-body -->
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="box box-info">

                                <div class="box-body">
                                    <div id="chart-recovered_10camp" style="min-width: 300px; height: 350px; max-width:inherit">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--- End of the 10 Camp Trends --->

    {#<div class="row">#}
        {#<div class="col-md-12">#}
            {#<div class="box-warning box">#}
                {#<div class="box-body">#}
                    {#<div id="chart-nss_3camp" style="min-width: 310px; height: 400px; max-width:inherit">#}
                        {#{{ dump(lastCampData) }}#}
                    {#</div>#}
                {#</div>#}
            {#</div>#}
        {#</div>#}
    {#</div>#}
    {#<div class="row">#}
        {#<div class="col-md-12">#}
            {#<div class="box-default box">#}
                {#<div class="box-body">#}
                    {#<div id="chart-refusal_3camp" style="min-width: 310px; height: 400px; max-width:inherit"></div>#}
                {#</div>#}
            {#</div>#}
        {#</div>#}
    {#</div>#}
    {#<div class="row">#}
        {#<div class="col-md-12">#}
            {#<div class="box-danger box">#}

                {#<div class="box-body">#}
                    {#<div id="chart-vac_usage" style="min-width: 310px; height: 400px; max-width:inherit"></div>#}
                {#</div>#}
            {#</div>#}
        {#</div>#}
    {#</div>#}

{% endblock %}

{% block header %}
    {% embed 'shared/header.html.twig' %}
        {% block filter %}
            {{ render(controller(
            'AppBundle:Ajax/AjaxFilter:smallFilter',
            { 'source': 'CatchupData'}
            ))
            }}
        {% endblock %}
    {% endembed %}
{% endblock %}

{% block css %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('custom_js_css/custom-style.css') }}">
{% endblock %}
{% block js_head %}
    <script src="{{ asset('template/bower_components/jquery/dist/jquery.min.js')}}"></script>
    <!-- Bootstrap 3.3.7 -->
    <script src="{{ asset('template/bower_components/bootstrap/dist/js/bootstrap.min.js') }}"></script>

    <script  src="{{ asset('template/plugins/bootstrap-multiselect/js/bootstrap-multiselect.js') }}"></script>

    <script src="//cdnjs.cloudflare.com/ajax/libs/numeral.js/2.0.6/numeral.min.js"></script>

    <!-- AdminLTE App -->
    <script src="{{ asset('template/dist/js/adminlte.min.js') }}"></script>

    <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
    <script src="{{ path('fos_js_routing_js', {'callback': 'fos.Router.setData'}) }}"></script>

{% endblock %}
{% block js %}
    <script src="{{ asset('custom_js_css/charts-wrapper.js') }}"></script>
    <script>
        $(document).ready(function () {

            // ========================= General Configuration for charts =================
            const config = new Array();
            config['vac_child_10camp'] = {'chart':{'type':"column"}, 'color':['#43AB0D']};
            config['missed_10camp'] = {'chart':{'type':"column"}, 'color':['#C99900']};
            config['missed_type_10camp'] = {'chart':{'type':"column", 'stacking':'normal'}, 'color':['#FFFF00', '#C99900', '#FF0000']};
            config['ten_camp_absent'] = {'color': ['#EAFF19', '#40C97A'],
                'chart':{'type':"column", 'stacking':'percent'}
            };
            config['ten_camp_nss'] = {'color': ['#9C800E', '#40C97A'],
                'chart':{'type':"column", 'stacking':'percent'}
            };
            config['ten_camp_refusal'] = {'color': ['#FF0000', '#40C97A'],
                'chart':{'type':"column", 'stacking':'percent'}};
            // third row
            config['ten_camp_absent_normal'] = {'color': ['#EAFF19', '#40C97A'],
                'chart':{'type':"column", 'stacking':'normal'}
            };
            config['ten_camp_nss_normal'] = {'color': ['#9C800E', '#40C97A'],
                'chart':{'type':"column", 'stacking':'normal'}
            };
            config['ten_camp_refusal_normal'] = {'color': ['#FF0000', '#40C97A'],
                'chart':{'type':"column", 'stacking':'normal'}};

            // =========================== Filter Menu Item Clicked For Campaign Type =========================
            $(".campaign-type").click(function (event){
                event.preventDefault();
                var target = $(this).data('url');
                var targetCont = "chart-"+ target;
                var ajaxUrl = "ajax_camp_statistics_catchup";
                var campaigns = $("#filterCampaign").val();
                var regions = $("#filterRegion").val();
                var provinces = $("#filterProvince").val();
                var districts = $("#filterDistrict").val();

                $('.'+target).show();
                var postData = {'campType': $(this).text(),
                                'entity': 'CatchupData',
                                'chartType': target,
                                'campaigns':campaigns,
                                'regions' : regions,
                                'provinces': provinces,
                                'districts': districts,
                               };
                //var stacking = target == "missed_type_10camp" ? {'type':'column', 'stacking':'normal'} : {'type':'column'};
                $.ajax({
                    url: Routing.generate(ajaxUrl),
                    data: postData,
                    type: 'POST',
                    success: function (data) {
                        //console.log(data);
                        var jsonData = JSON.parse(data);

                        myChartWrapper(config[target].chart,
                            targetCont, JSON.stringify(jsonData[target]),
                            null, null, config[target].color);
                        $('.'+target).hide();
                    },
                    cache: false
                });

                //alert($(this).text()+" and "+$(this).data('url') + " and " + target);
            })

            //============================== Tree Menu ========================================
            var checkElement = $('.menu-open .treeview-menu');
            if ((checkElement.is('.treeview-menu')) && (!checkElement.is(':visible'))) {
                //Get the parent menu
                var parent = checkElement.parents('ul').first();
                //Close all open menus within the parent
                var ul = parent.find('ul:visible').slideUp(500);
                //Remove the menu-open class from the parent
                ul.removeClass('menu-open');
                //Get the parent li
                var parent_li = checkElement.parent("li");

                //Open the target menu and add the menu-open class
                checkElement.slideDown(500, function () {
                    //Add the class active to the parent li
                    checkElement.addClass('menu-open');
                    //parent.find('li.active').removeClass('active');
                    parent_li.addClass('active');
                    //Fix the layout in case the sidebar stretches over the height of the window
                    //_this.layout.fix();
                });
            }

            // =============================== End of Tree Menu ==================================

            $('.loading, .loading-top').hide();

            // =============================== Load the charts for the first time ================

            myPieChartWrapper('chart-pie_chart_1camp', '{{ lastCampPieData|raw }}', null, ['#FFFF00', '#C99900', '#FF0000'], null, 'donut', 'small');
            myChartWrapper({'type':"column"}, "chart-column_chart_1camp", '{{ lastCampVacData|raw }}',
                {'yTitle':null, 'xTitle':null}, {'enabled':false}, ['#FFB32D']);

            // Second Row of the last campaign charts
            myPieChartWrapper('chart-recovered_all', '{{ recoveredAll|raw }}', null,
                ['#40C97A', '#FFB32D'], null, 'halfpie', 'small');
            myPieChartWrapper('chart-recovered_absent', '{{ recoveredAbsent|raw }}', null,
                ['#40C97A', '#FFFF00'], null, 'halfpie', 'small');
            myPieChartWrapper('chart-recovered_nss', '{{ recoveredNSS|raw }}', null,
                ['#40C97A', '#9C800E'], null, 'halfpie', 'small');
            myPieChartWrapper('chart-recovered_refusal', '{{ recoveredRefusal|raw }}', null,
                ['#40C97A', '#FF0000'], null, 'halfpie', 'small');

            // Last 10 campaign trends
            myChartWrapper(config['vac_child_10camp'].chart, "chart-vac_child_10camp", '{{ chartVacChild10Camp|raw }}',
                {'yTitle':null, 'xTitle':null}, null, config['vac_child_10camp'].color);
            myChartWrapper(config['missed_10camp'].chart, "chart-missed_10camp", '{{ chartMissed10Camp|raw }}',
                {'yTitle':null, 'xTitle':null}, null, config['missed_10camp'].color);
            myChartWrapper(config['missed_type_10camp'].chart, "chart-missed_type_10camp", '{{ chartMissedType10camp|raw }}',
                {'yTitle':null, 'xTitle':null}, null, config['missed_type_10camp'].color);
            // new row for 10 campaign
            myChartWrapper(config['ten_camp_absent'].chart, "chart-ten_camp_absent", '{{ chartAbsentRec10Camp|raw }}',
                {'yTitle':null, 'xTitle':null}, null, config['ten_camp_absent'].color);
            myChartWrapper(config['ten_camp_nss'].chart, "chart-ten_camp_nss", '{{ chartNSSRec10Camp|raw }}',
                {'yTitle':null, 'xTitle':null}, null, config['ten_camp_nss'].color);
            myChartWrapper(config['ten_camp_refusal'].chart, "chart-ten_camp_refusal", '{{ chartRefusalRec10Camp|raw }}',
                {'yTitle':null, 'xTitle':null}, null, config['ten_camp_refusal'].color);

            // new row for 10 campaign
            myChartWrapper(config['ten_camp_absent_normal'].chart, "chart-ten_camp_absent_normal", '{{ chartAbsentRec10Camp|raw }}',
                {'yTitle':null, 'xTitle':null}, null, config['ten_camp_absent_normal'].color);
            myChartWrapper(config['ten_camp_nss_normal'].chart, "chart-ten_camp_nss_normal", '{{ chartNSSRec10Camp|raw }}',
                {'yTitle':null, 'xTitle':null}, null, config['ten_camp_nss_normal'].color);
            myChartWrapper(config['ten_camp_refusal_normal'].chart, "chart-ten_camp_refusal_normal", '{{ chartRefusalRec10Camp|raw }}',
                {'yTitle':null, 'xTitle':null}, null, config['ten_camp_refusal_normal'].color);

            myChartWrapper({'type':"area", 'stacking':'percent'}, "chart-recovered_10camp", '{{ last10CampRecovered|raw }}',
                {'yTitle':null, 'xTitle':null}, null,
               ['#FFDE7B', '#33D3FF', '#42FFC0', '#40C97A']);
            {##}
            {#colChart('chart-vac_child_10camp', '{{ chartVacChild10Camp|raw }}', config['vac_child_10camp'].title, config['vac_child_10camp'].color);#}
            {#colChart('chart-missed_10camp', '{{ chartMissed10Camp|raw }}', config['missed_10camp'].title, config['missed_10camp'].color);#}
            {#colChart('chart-missed_type_10camp', '{{ chartMissedType10camp|raw }}', config['missed_type_10camp'].title, config['missed_type_10camp'].color);#}
            {#colChart('chart-absent_3camp', '{{ chartDataAbsent|raw }}', config['absent_3camp'].title, config['absent_3camp'].color);#}
            {#colChart('chart-nss_3camp', '{{ chartDataNss|raw }}', config['nss_3camp'].title, config['nss_3camp'].color);#}
            {#colChart('chart-refusal_3camp', '{{ chartDataRefusal|raw }}', config['refusal_3camp'].title,config['refusal_3camp'].color);#}
            {#threeAxisChart('chart-vac_usage', '{{ chartVaccineUsage|raw }}', ['Received vials', 'Used vials', 'Wastage'],#}
                {#['ReceivedVials', 'UsedVials', 'Wastage']);#}

            // ============================== End loading of the charts ==========================
            $('#filterDistrict').change(function () {
                //$('.btn-cluster').hide();
                var districts = $('#filterDistrict option:selected');

                var selectedDistricts = [];
                $(districts).each(function (index, districts) {

                    selectedDistricts.push([$(districts).val()]);
                });

                if(selectedDistricts.length === 1) {
                    var districtId = $('#filterDistrict').val();
                    //console.log(districtId[0].indexOf("HR"));
                    if(districtId[0].indexOf("HR") == -1) {
                        var url = Routing.generate('cluster_catchup_data', {'district': districtId})
                        $('.btn-cluster').html("<i class='fa fa-mail-forward'></i> Clusters' data for " + $('#filterDistrict option:selected').attr('label'));
                        $('.btn-cluster').attr("href", url);
                        //$('.btn-cluster').show();
                    }
                } else {
                    $('.btn-cluster').html("<i class='fa fa-mail-forward'></i> For clusters' data click here!");
                    $('.btn-cluster').attr("href", Routing.generate('cluster_catchup_data'));
                }
            })

            $('#filterButton').click(function () {

                var campaigns = $('#filterCampaign').val();

                var region = $('#filterRegion').val();

                var provinces = $('#filterProvince').val();

                var districts = $('#filterDistrict').val();

                // check if a user didn't select anything, then return
                if(campaigns === null || campaigns === undefined) {
                    window.alert("Please select at least one campaign");
                    return;
                }

                var data = {'campaign':campaigns, 'region':region, 'province': provinces, 'district': districts};

                $('.loading, .loading-top').show();


                $.ajax({
                    url: Routing.generate('ajax_filter_catchup_data'),
                    data: data,
                    type: 'POST',
                    success: function (data) {
                        console.log(data);
                        var jsonData = JSON.parse(data);

                        // set new title for the row
                        $('.campaign-title').html(jsonData.campaign + " Campaign Data");

                        // set the new info
                        $('.info-row').html(jsonData.info);
                        // set new table
                        $('.table-campaign-info').html(jsonData.table.table);

                        myPieChartWrapper('chart-pie_chart_1camp', JSON.stringify(jsonData.lastCampPieData), null, ['#FFFF00', '#C99900', '#FF0000'], null, 'donut', 'small');
                        myChartWrapper({'type':"column"}, "chart-column_chart_1camp", JSON.stringify(jsonData.lastCampVacData),
                            {'yTitle':null, 'xTitle':null}, {'enabled':false}, ['#FFB32D']);

                        // Second Row of the last campaign charts
                        myPieChartWrapper('chart-recovered_all', JSON.stringify(jsonData.recoveredAll), null,
                            ['#40C97A', '#FFB32D'], null, 'halfpie', 'small');
                        myPieChartWrapper('chart-recovered_absent', JSON.stringify(jsonData.recoveredAbsent), null,
                            ['#40C97A', '#FFFF00'], null, 'halfpie', 'small');
                        myPieChartWrapper('chart-recovered_nss', JSON.stringify(jsonData.recoveredNSS), null,
                            ['#40C97A', '#9C800E'], null, 'halfpie', 'small');
                        myPieChartWrapper('chart-recovered_refusal', JSON.stringify(jsonData.recoveredRefusal), null,
                            ['#40C97A', '#FF0000'], null, 'halfpie', 'small');

                        // Last 10 campaign trends
                        myChartWrapper({'type':"column"}, "chart-vac_child_10camp", JSON.stringify(jsonData.chartVacChild10Camp),
                            {'yTitle':null, 'xTitle':null}, null, config['vac_child_10camp'].color);
                        myChartWrapper({'type':"column"}, "chart-missed_10camp", JSON.stringify(jsonData.chartMissed10Camp),
                            {'yTitle':null, 'xTitle':null}, null, config['missed_10camp'].color);
                        myChartWrapper({'type':"column", 'stacking':'normal'}, "chart-missed_type_10camp", JSON.stringify(jsonData.chartMissedType10camp),
                            {'yTitle':null, 'xTitle':null}, null, config['missed_type_10camp'].color);
                        // new row for 10 campaign
                        myChartWrapper(config['ten_camp_absent'].chart, "chart-ten_camp_absent",  JSON.stringify(jsonData.chartAbsentRec10Camp),
                            {'yTitle':null, 'xTitle':null}, null, config['ten_camp_absent'].color);
                        myChartWrapper(config['ten_camp_nss'].chart, "chart-ten_camp_nss",  JSON.stringify(jsonData.chartNSSRec10Camp),
                            {'yTitle':null, 'xTitle':null}, null, config['ten_camp_nss'].color);
                        myChartWrapper(config['ten_camp_refusal'].chart, "chart-ten_camp_refusal",  JSON.stringify(jsonData.chartRefusalRec10Camp),
                            {'yTitle':null, 'xTitle':null}, null, config['ten_camp_refusal'].color);
                        // new row for 10 campaign
                        myChartWrapper(config['ten_camp_absent_normal'].chart, "chart-ten_camp_absent_normal",  JSON.stringify(jsonData.chartAbsentRec10Camp),
                            {'yTitle':null, 'xTitle':null}, null, config['ten_camp_absent_normal'].color);
                        myChartWrapper(config['ten_camp_nss_normal'].chart, "chart-ten_camp_nss_normal",  JSON.stringify(jsonData.chartNSSRec10Camp),
                            {'yTitle':null, 'xTitle':null}, null, config['ten_camp_nss_normal'].color);
                        myChartWrapper(config['ten_camp_refusal_normal'].chart, "chart-ten_camp_refusal_normal",  JSON.stringify(jsonData.chartRefusalRec10Camp),
                            {'yTitle':null, 'xTitle':null}, null, config['ten_camp_refusal_normal'].color);
                        // area chart
                        myChartWrapper({'type':"area", 'stacking':'percent'}, "chart-recovered_10camp", JSON.stringify(jsonData.last10CampRecovered),
                            {'yTitle':null, 'xTitle':null}, null,
                            ['#FFDE7B', '#33D3FF', '#42FFC0', '#40C97A']);

                        $('.loading, .loading-top').hide();
                    },
                    cache: false
                });

            })
        });


    </script>
{% endblock %}