# To get started with security, check out the documentation:
# https://symfony.com/doc/current/security.html
security:
    # security encryption
    encoders:
            AppBundle\Entity\User: bcrypt

    role_hierarchy:
            ROLE_USER: ROLE_VIEWER
            ROLE_ADMIN:       ROLE_USER
            ROLE_SUPER_ADMIN: ROLE_ADMIN

    # https://symfony.com/doc/current/security.html#b-configuring-how-users-are-loaded
    providers:
            fos_userbundle:
                id: fos_user.user_provider.username_email

#    access_control:
#
#            #fosbundle routes
#            - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            - { path: ^/login_check$, role: IS_AUTHENTICATED_ANONYMOUSLY } # for the case of a failed login
#            - { path: ^/user/new$, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            - { path: ^/user/check-confirmation-email$, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            - { path: ^/user/confirm/, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            - { path: ^/user/confirmed$, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            - { path: ^/user/request-reset-password$, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            - { path: ^/user/send-resetting-email$, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            - { path: ^/user/check-resetting-email$, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            - { path: ^/user/reset-password/, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            - { path: ^/resetting/request, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            # Secured part of the site
#            # This config requires being logged for the whole site and having the admin role for the admin part.
#            # Change these rules to adapt them to your needs
#            - { path: ^/admin/, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            - { path: ^/login$, role: IS_AUTHENTICATED_ANONYMOUSLY }
#            - { path: ^/.*, roles: [ROLE_USER]}

    firewalls:
            main:
                pattern: ^/
                form_login:
                    provider: fos_userbundle
                    csrf_token_generator: security.csrf.token_manager
                    # if you are using Symfony < 2.8, use the following config instead:
                    # csrf_provider: form.csrf_provider

                logout:       true
                anonymous:    true
        # disables authentication for assets and the profiler, adapt it according to your needs
            dev:
                pattern: ^/(_(profiler|wdt)|css|images|js)/
                security: false

            admin:
                pattern:            /admin(.*)
                context:            user
                form_login:
                    provider:       fos_userbundle
                    login_path:     /login
                    use_forward:    false
                    check_path:     /admin/login_check
                    failure_path:   null
                logout:
                    path:           /admin/logout
                    target:         /login
                anonymous:          true


            # activate different ways to authenticate

            # https://symfony.com/doc/current/security.html#a-configuring-how-your-users-will-authenticate
            #http_basic: ~

            # https://symfony.com/doc/current/security/form_login_setup.html
            #form_login: ~
